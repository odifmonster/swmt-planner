# EDIT DATA SOURCE INFO HERE

# Any text following a pound sign is ignored
# End a line in ... if you want the next line to be included as part of the previous one

# Provide a list of required arguments and types here

[Args] INPUT_ARGS:
    req_weekof=Date1 # Date1 takes the form YYYYMMDD
    req_day=Date2 # Date2 takes the form m-d
    report_day=Date1

SOURCE1 = "/Users/lamanwyner/Desktop/Shawmut Projects/Scheduling"
SOURCE2 = Concat(SOURCE1, "/Reports") # Concatenate strings together

MASTER = Concat("PA plant orders against Lam demand ", INPUT_ARGS.req_weekof, ".xlsx")
LAM_PLAN = "LamDemandPlanning.xlsx"

jet_nums = [*(1 to 4), *(7 to 10)] # Use 'to' to define a range of integers (inclusive both ends)
jets = Map(jet_nums, i -> Concat("JET ", i))

req_wks = 0 to 5
req_cols = ["FAB req'd past due", *Map(req_wks, wk -> Concat("Fab req'd WK", wk))]

# Blocks representing file reading info must be marked as 'Excel' or 'CSV'

[ProductInfo] product_info:
    [Excel] dye_formulae:
        folder=SOURCE1
        workbook=LAM_PLAN
        sheet="Xref"
        col_names=["COLOR NAME", "COLOR NUMBER", "SHADE RATING"]
    [Excel] fab_items:
        # folder, workbook, and sheet are required for 'Excel' blocks
        folder=SOURCE1
        workbook=LAM_PLAN
        sheet="Xref"
        col_names=["GREIGE ITEM", "STYLE", "WD", "Yield", "STATUS", "COLOR NUMBER", ...
            "PA FIN ITEM", *jets] # Use a * to "unpack" lists
    [Excel] greige_styles:
        folder=SOURCE1
        workbook=LAM_PLAN
        sheet="Griege Sizes"

[Excel] greige_translation:
    folder=SOURCE1
    workbook=LAM_PLAN
    sheet="Greige Style Translation"
    subst_names=["inventory", "plan"]
    start_row=2

[Excel] jet_info:
    folder=SOURCE1
    workbook="master.xlsx"
    sheet="jets"

[Excel] pa_floor_inv:
    folder=SOURCE1
    workbook=MASTER
    sheet="1427"

[CSV] pa_audit:
    folder=SOURCE2
    fname=Concat("2010_", INPUT_ARGS.report_day, ".csv")
    
[DyeOrders] dye_orders:
    [Excel] adaptive:
        folder=SOURCE1
        workbook=MASTER
        sheet="Adaptive2"
    [Excel] pa_714:
        folder=SOURCE1
        workbook=MASTER
        sheet="714"

[Excel] pa_reqs:
    folder=SOURCE1
    workbook=MASTER
    sheet=Concat("Fab shortage ", INPUT_ARGS.req_day)
    col_names=["PA Item", "Ply1 Item", *req_cols, "PA Fin", "Inspection", ...
        "Frame", "Dye Orders"]